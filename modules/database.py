from modules.config import cursor, conn, USER_ID

def register_user(telegram_id, is_admin):
    cursor.execute('INSERT INTO users (telegram_id, is_admin) VALUES (?, ?)', (telegram_id, is_admin))
    conn.commit()

def is_registered(telegram_id):
    cursor.execute('SELECT * FROM users WHERE telegram_id = ?', (telegram_id,))
    return cursor.fetchone() is not None

def register_admin():
    if not is_registered(USER_ID):
        register_user(USER_ID, True) 
        
def is_admin(telegram_id):
    cursor.execute('SELECT * FROM users WHERE telegram_id = ?', (telegram_id,))
    result = cursor.fetchone()
    if result is not None:
        telegram_id, admin = result
        return admin
    return False
       
def update_user_role(telegram_id, is_admin):
    cursor.execute('UPDATE users SET is_admin = ? WHERE telegram_id = ?', (is_admin, telegram_id))
    conn.commit()

def delete_user(telegram_id):
    cursor.execute('DELETE FROM users WHERE telegram_id = ?', (telegram_id,))
    conn.commit()
